{
  "version": 3,
  "sources": ["../../../src/react-clerk/ConvexProviderWithClerk.tsx"],
  "sourcesContent": ["import { useAuth } from \"@clerk/clerk-react\";\nimport React from \"react\";\n\nimport { ReactNode, useCallback, useMemo } from \"react\";\nimport { AuthTokenFetcher, ConvexProviderWithAuth } from \"../react/index.js\";\n\n// Until we can import from our own entry points (requires TypeScript 4.7),\n// just describe the interface enough to help users pass the right type.\nexport type IConvexReactClient = {\n  setAuth(fetchToken: AuthTokenFetcher): Promise<void>;\n  clearAuth(): void;\n};\n\n/**\n * A wrapper React component which provides a {@link react.ConvexReactClient}\n * authenticated with Clerk.\n *\n * It must be wrapped by a configured `ClerkProvider`, from\n * `@clerk/clerk-react`, `@clerk/clerk-expo`, `@clerk/clerk-next` or\n * another React-based Clerk client library.\n *\n * See [Convex Clerk](https://docs.convex.dev/auth/clerk) on how to set up\n * Convex with Clerk.\n *\n * @public\n */\nexport function ConvexProviderWithClerk({\n  children,\n  client,\n}: {\n  children: ReactNode;\n  client: IConvexReactClient;\n}) {\n  return (\n    <ConvexProviderWithAuth client={client} useAuth={useAuthFromClerk}>\n      {children}\n    </ConvexProviderWithAuth>\n  );\n}\n\nfunction useAuthFromClerk() {\n  const { isLoaded, isSignedIn, getToken } = useAuth();\n  const fetchAccessToken = useCallback(\n    () => getToken({ template: \"convex\", skipCache: true }),\n    // Clerk is not memoizing its getToken function at all\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n  return useMemo(\n    () => ({\n      isLoading: !isLoaded,\n      isAuthenticated: isSignedIn ?? false,\n      fetchAccessToken,\n    }),\n    [isLoaded, isSignedIn, fetchAccessToken]\n  );\n}\n"],
  "mappings": ";AAAA,SAAS,eAAe;AACxB,OAAO,WAAW;AAElB,SAAoB,aAAa,eAAe;AAChD,SAA2B,8BAA8B;AAsBlD,gBAAS,wBAAwB;AAAA,EACtC;AAAA,EACA;AACF,GAGG;AACD,SACE,oCAAC,0BAAuB,QAAgB,SAAS,oBAC9C,QACH;AAEJ;AAEA,SAAS,mBAAmB;AAC1B,QAAM,EAAE,UAAU,YAAY,SAAS,IAAI,QAAQ;AACnD,QAAM,mBAAmB;AAAA,IACvB,MAAM,SAAS,EAAE,UAAU,UAAU,WAAW,KAAK,CAAC;AAAA,IAGtD,CAAC;AAAA,EACH;AACA,SAAO;AAAA,IACL,OAAO;AAAA,MACL,WAAW,CAAC;AAAA,MACZ,iBAAiB,cAAc;AAAA,MAC/B;AAAA,IACF;AAAA,IACA,CAAC,UAAU,YAAY,gBAAgB;AAAA,EACzC;AACF;",
  "names": []
}
